version: '3.8'
services:
  suitecrm:
    image: suitecrm:latest
    ports:
      - '80:80'
    environment:
      DATABASE_HOST: suitecrm-mariadb
      DATABASE_PORT: '3306'
      DATABASE_NAME: suitecrm
      DATABASE_USER: suitecrm
      DATABASE_PASSWORD: suitecrm-mariadb-password
      SUITECRM_URL: http://localhost
      SUITECRM_ADMIN_USER: '{user.userEmail}'
      SUITECRM_ADMIN_PASSWORD: suitecrm-admin-password
      SUITECRM_INSTALL_DEMO_DATA: 'no'
    x-clouve-environment-types:
      DATABASE_HOST: containerReference
      DATABASE_PORT: static
      DATABASE_NAME: static
      DATABASE_USER: static
      DATABASE_PASSWORD: secret
      SUITECRM_URL: applicationUrl
      SUITECRM_ADMIN_USER: applicationUsername
      SUITECRM_ADMIN_PASSWORD: applicationPassword
      SUITECRM_INSTALL_DEMO_DATA: static
    volumes:
      - suitecrm-data:/var/www/html
    x-clouve-metadata:
      containerName: suitecrm
      purpose: Frontend
      protocol: TCP
      isPublic: true
      memoryBase: 2
      cpuBase: 1
    x-clouve-bundle-metadata:
      appVersion: 8.9.1
      appTitle: SuiteCRM
      appDescription: SuiteCRM is a powerful, open-source customer relationship management (CRM) platform designed to help businesses enhance customer engagement and drive growth. With its comprehensive suite of features, including sales automation, marketing, customer support, and reporting, SuiteCRM provides a 360-degree view of customer interactions. The platform's flexibility allows businesses to tailor it to their specific needs, while its robust customization options ensure seamless integration with existing systems. By centralizing customer data and streamlining processes, SuiteCRM improves efficiency, fosters better decision-making, and boosts customer satisfaction, making it an ideal solution for businesses looking to build stronger relationships and achieve long-term success.
    x-clouve-healthcheck:
      enabled: true
      type: HTTP
      path: /
      port: 80
      initialDelay: 30
      interval: 15
      timeout: 15
      failureThreshold: 5
      successThreshold: 1
    healthcheck:
      test:
        - CMD
        - wget
        - '--spider'
        - '-q'
        - http://localhost:80/
      interval: 15s
      timeout: 15s
      retries: 5
      start_period: 30s
    x-clouve-volumes:
      - name: suitecrm-data
        size: 10
        description: Volume for SuiteCRM application files and data
  suitecrm-mariadb:
    image: suitecrm-mariadb:latest
    ports:
      - '3306:3306'
    environment:
      MYSQL_DATABASE: suitecrm
      MYSQL_USER: suitecrm
      MYSQL_PASSWORD: suitecrm-mariadb-password
      MYSQL_ROOT_PASSWORD: suitecrm-mariadb-root-password
    x-clouve-environment-types:
      MYSQL_DATABASE: static
      MYSQL_USER: static
      MYSQL_PASSWORD: secret
      MYSQL_ROOT_PASSWORD: secret
    volumes:
      - suitecrm-db-data:/var/lib/mysql
    x-clouve-metadata:
      containerName: suitecrm-mariadb
      purpose: Database
      protocol: TCP
      isPublic: false
      memoryBase: 1
      cpuBase: 0.5
    x-clouve-healthcheck:
      enabled: false
      type: HTTP
      path: /health
      port: 3306
      initialDelay: 30
      interval: 10
      timeout: 5
      failureThreshold: 3
      successThreshold: 1
    x-clouve-volumes:
      - name: suitecrm-db-data
        size: 10
        description: Volume for MariaDB database files
volumes:
  suitecrm-data:
    driver: local
  suitecrm-db-data:
    driver: local
